# SchulteGrid

![Android](https://img.shields.io/badge/Android-24%2B-green)
![Kotlin](https://img.shields.io/badge/Kotlin-1.8-blue)
![License](https://img.shields.io/badge/License-MIT-yellow)

## 项目简介

SchulteGrid（舒尔特方格助手）是一款基于 Android 无障碍服务的自动化工具，用于辅助完成舒尔特方格注意力训练。该应用通过悬浮窗界面提供便捷的控制，能够自动识别并点击屏幕上的数字，帮助用户进行舒尔特方格训练。

## 功能特性

### 核心功能
- **自动点击**：自动识别并按顺序点击 1-50 的数字
- **悬浮窗控制**：提供便捷的悬浮窗界面，可拖动、透明化
- **框选区域**：支持框选特定区域，限制搜索范围
- **延迟调节**：可动态调节搜索延迟（50ms - 999ms）
- **透明模式**：支持悬浮窗透明化，不遮挡屏幕内容
- **误差模式**：可启用随机延迟，模拟真实点击

### 技术亮点
- 基于 Android AccessibilityService 实现无障碍操作
- 使用 GestureDescription 执行精确的点击手势
- 协程（Coroutines）处理异步任务
- 前台服务确保稳定运行
- 智能节点搜索，排除干扰元素

## 系统要求

- Android 7.0 (API 24) 或更高版本
- 需要授予无障碍服务权限
- 需要授予悬浮窗权限

## 安装使用

### 1. 安装应用
下载 APK 文件并安装到 Android 设备上。

### 2. 授权无障碍服务
1. 打开应用
2. 点击「打开无障碍设置」
3. 在无障碍服务列表中找到「舒尔特方格助手」
4. 开启该服务

### 3. 授权悬浮窗权限
1. 点击「授权悬浮窗权限」
2. 在系统设置中允许该应用显示在其他应用上层

### 4. 启动悬浮窗
1. 点击「启动悬浮窗」或「一键启动」
2. 主界面关闭，悬浮窗显示在屏幕上

### 5. 开始使用
1. 打开舒尔特方格网页或应用
2. 点击悬浮窗的「开始」按钮
3. 应用将自动按顺序点击数字 1-50
4. 完成后会自动重新开始

## 悬浮窗功能说明

| 功能    | 说明                  |
|-------|---------------------|
| 开始/停止 | 控制自动点击的启动和停止        |
| 框选区域  | 在屏幕上拖动选择特定区域，限制搜索范围 |
| 清除框选  | 清除已设置的框选区域          |
| 透明    | 切换悬浮窗的透明模式          |
| 延迟调节  | 调节搜索延迟时间（50-999ms）  |
| 关闭    | 关闭悬浮窗服务             |

## 高级功能

### 框选区域
1. 点击「框选区域」按钮
2. 在屏幕上拖动选择要搜索的区域
3. 框选完成后，应用只会在该区域内搜索数字
4. 点击「清除框选」可取消框选限制

### 透明模式
1. 点击「透明」按钮进入透明模式
2. 悬浮窗将几乎完全透明，不遮挡屏幕内容
3. 再次点击该位置可恢复正常模式
4. 透明模式下仍可点击开始/停止按钮

### 误差模式
1. 在主界面点击「启动误差」按钮
2. 启用后，每次搜索会添加随机延迟（0-80%）
3. 用于模拟真实点击的不确定性

## 项目结构

```
SchulteGrid/
├── app/
│   └── src/
│       └── main/
│           ├── java/com/core/app/schultegrid/
│           │   ├── MainActivity.kt                      # 主界面
│           │   ├── FloatingWindowService.kt             # 悬浮窗服务
│           │   └── SchulteGridAccessibilityService.kt   # 无障碍服务
│           ├── res/
│           │   ├── layout/
│           │   │   ├── activity_main.xml                 # 主界面布局
│           │   │   └── floating_window.xml              # 悬浮窗布局
│           │   └── xml/
│           │       └── accessibility_service_config.xml # 无障碍服务配置
│           └── AndroidManifest.xml
├── gradle/
├── build.gradle
└── settings.gradle
```

## 技术实现

### 无障碍服务
- 使用 `AccessibilityService` 监听屏幕内容
- 通过 `rootInActiveWindow` 获取界面节点树
- 递归搜索匹配的数字节点
- 使用 `GestureDescription` 执行点击手势

### 悬浮窗服务
- 使用 `WindowManager` 创建悬浮窗
- 支持拖动和透明模式切换
- 前台服务确保稳定运行
- 动态更新 UI 状态

### 搜索算法
- 深度优先搜索（DFS）遍历节点树
- 精确匹配纯数字文本（1-50）
- 排除包含 "level" 等关键词的干扰节点
- 支持框选区域限制搜索范围

## 开发环境

- Android Studio Hedgehog (2023.1.1) 或更高版本
- Gradle 8.0+
- Kotlin 1.8+
- Android SDK 34
- 最低支持 SDK 24 (Android 7.0)

## 构建项目

```bash
# 克隆项目
git clone https://github.com/Yuantris/SchulteGrid.git
cd SchulteGrid

# 构建项目
./gradlew build

# 安装到设备
./gradlew installDebug
```

## 注意事项

1. **权限要求**：必须授予无障碍服务和悬浮窗权限才能正常使用
2. **兼容性**：不同应用和网页的界面结构可能影响识别效果
3. **性能**：延迟设置过低可能导致性能问题或点击失败
4. **隐私**：无障碍服务需要读取屏幕内容，请确保在可信环境下使用

## 常见问题

### Q: 为什么无法找到数字？
A: 请检查：
- 无障碍服务是否已启用
- 悬浮窗权限是否已授予
- 数字是否在框选区域内（如果设置了框选）
- 延迟设置是否过低

### Q: 点击不准确怎么办？
A: 可以尝试：
- 增加搜索延迟时间
- 使用框选功能限制搜索范围
- 检查目标应用是否支持无障碍操作

### Q: 如何关闭悬浮窗？
A: 点击悬浮窗右上角的「×」按钮即可关闭

## 许可证

本项目采用 MIT 许可证，详见 [LICENSE](LICENSE) 文件。

## 作者

**Yuantris**

## 致谢

感谢所有为本项目提供帮助和反馈的用户。

## 更新日志

### v1.0.0 (2025-02-08)
- 初始版本发布
- 实现基本的自动点击功能
- 添加悬浮窗控制界面
- 支持框选区域和延迟调节
- 添加透明模式和误差模式

## 贡献

欢迎提交 Issue 和 Pull Request！

## 免责声明

本工具仅供学习和研究使用，请勿用于任何商业用途或违反服务条款的行为。使用本工具所产生的一切后果由使用者自行承担。
